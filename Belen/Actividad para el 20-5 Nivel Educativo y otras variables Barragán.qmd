---
title: "Actividad para el 20-5 Barragán"
author: "Barragán"
format: html
editor: visual
---

## Issue n°64:Capitulo Educación e ingreso

-   ¿En qué medida influye el **nivel educativo** en el ingreso de la persona?

    -   ¿Controlando por la variable de **sexo**?

    -   ¿Es lo mismo para todas las provincias y/o **regiones**?

    -   ¿Es lo mismo en **ciudades grandes** (+500) y en las **ciudades chicas**?

Variables a analizar en relación al nivel educativo(NIVEL_ED):

-   Sexo (CH04)

-   Regiones (REGION)

-   Ciudades grandes y cuidades chicas(MAS_500)

```{r}
library(tidyverse)
```

```{r}
my_data <- readRDS("/cloud/project/data/datos_indec.rds")
```

```{r}
temp_df <- my_data |> 
  select(NIVEL_ED,CH04,REGION,MAS_500)
```

## Cambiando nombre a las columnas

```{r}
temp_df |> 
  mutate (Nivel_Educativo = "NIVEL_ED")
```

```{r}
temp_df <- temp_df |> 
  mutate(Nivel_Educativo = 
           case_when(
             NIVEL_ED == 1 ~ "Primario incompleto (incluye educación especial)",
             NIVEL_ED == 2 ~ "Primario completo",
             NIVEL_ED == 3 ~ "Secundario incompleto",
             NIVEL_ED == 4 ~ "Secundario completo",
             NIVEL_ED == 5 ~ "Superior universitario incompleto",
             NIVEL_ED == 6 ~ "Superior universitario completo",
             NIVEL_ED == 7 ~ "Sin instrucción"))
temp_df
```

```{r}
temp_df |> 
  mutate (Regiones = "REGION")
```

```{r}
temp_df <- temp_df |> 
  mutate(Region = 
           case_when(
             Region == 01 ~ "Gran Buenos Aires",
             Region == 40 ~ "Noroeste",
             Region == 41 ~ "Noreste",
             Region == 42 ~ "Cuyo",
             Region == 43 ~ "Pampeana",
             Region == 44 ~ "Patagonia",
             .default = "No Encontrado")
temp_df
```

```{r}
temp_df |> 
  mutate (Sexo = "CH04")
```

```{r}
temp_df <- temp_df |> 
  mutate(Sexo = case_when(
    x == "1" ~ "Varon",
    x == "2" ~ "Mujer",
    .default = "desconocido")
temp_df
```

```{r}
temp_df <- temp_df |> 
  mutate(conjunto_de_aglomerados=
  case_when(
    aglomerado=="N"~ "menos de 500.000 habitantes",
    aglomerado=="S"~ "igual o más de 500.000 habitantes")

```

## Relacion del nivel educativo con las variables(Regiones, Sexo y Aglomeración)

```{r}
my_data <- my_data |> 
  mutate(Nivel_Educativo = "NIVEL_ED") |> 
  mutate(Region = nombrar_regiones(REGION) = case_when( 
             Region == 01 ~ "Gran Buenos Aires",
             Region == 40 ~ "Noroeste",
             Region == 41 ~ "Noreste",
             Region == 42 ~ "Cuyo",
             Region == 43 ~ "Pampeana",
             Region == 44 ~ "Patagonia",
             .default = "No Encontrado"
   
  ))
table(my_data$Nivel_Educativo,my_data$Region)
```

```{r}
my_data <- my_data |> 
  mutate(Nivel_Educativo = "NIVEL_ED") |> 
  mutate(Sexo = nombrar_ch04(CH04)= case_when(
    x == "1" ~ "Varon",
    x == "2" ~ "Mujer",
    .default = "desconocido"
  )
table(my_data$Nivel_Educativo,my_data$Sexo)
```

```{r}
my_data <- my_data |> 
  mutate(Nivel_Educativo = "NIVEL_ED") |> 
  mutate(Ciudad_grande = conjunto_de_aglomerados= case_when(
    aglomerado=="N"~ "menos de 500.000 habitantes",
    aglomerado=="S"~ "igual o más de 500.000 habitantes"
  )
table(my_data$Nivel_Educativo,my_data$ciudad_grande)
```

```{r}
my_data |> 
  ggplot(aes(NIVEL_ED, fill = Region))+
  geom_bar()
```

```{r}
my_data |> 
  ggplot(aes(NIVEL_ED, fill = Sexo))+
  geom_bar()
```

```{r}
{r}
my_data |> 
  ggplot(aes(NIVEL_ED, fill = conjunto_de_aglomerados))+
  geom_bar()
```
