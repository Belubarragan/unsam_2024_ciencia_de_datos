---
title: "6. Educacion e Ingreso"
author: "Barragán"
format: html
editor: visual
---

## 6. Educación e Ingreso

## **Introducción**

En el presente capitulo se llevara a cabo un análisis cuantitativo referido al vinculo entre el nivel educativo y el ingreso con diversos factores tales como el sexo, la región geográfica y la aglomeración. Para tal proposito, se utilizaran datos del Instituto Nacional de Estadística y Censos (INDEC)([Censos y estadísticas 2023](/cloud/project/data/usu_individual_T423.rds)).

## **Datos**

Los datos que hemos usado para este análisis provienen del indec. Corresponden a la encuesta permanente de hogares para el 4to trimestre del 2023.

## **Preguntas de investigación**

¿En qué medida influye el **nivel educativo** en el **ingreso** de la persona?

-   ¿Controlando por la variable de **sexo**?

-   ¿Es lo mismo para todas las provincias y/o **regiones**?

-   ¿Es lo mismo en **ciudades grandes** (+500) y en las **ciudades chicas**?

Variables a analizar en relación al nivel educativo(NIVEL_ED) y el ingreso (ITF):

-   Sexo (CH04)

-   Regiones (REGION)

-   Ciudades grandes y cuidades chicas(MAS_500)

## **Herramientas de análisis**

Usamos el lenguaje R ([2024](https://dietrichson.github.io/unsam_2024_ciencia_de_datos/notas/analysis-ITF.html#ref-base)) con los paquetes de tidyverse. ([Wickham et al. 2019](https://dietrichson.github.io/unsam_2024_ciencia_de_datos/notas/analysis-ITF.html#ref-tidyverse)). Usamos el sistema Quarto (Allaire et al. ([2024](https://dietrichson.github.io/unsam_2024_ciencia_de_datos/notas/analysis-ITF.html#ref-Allaire_Quarto_2024))) para su publicación.

## Procedimiento

```{r}
library(tidyverse)
```

```{r}
my_data <- readRDS("/cloud/project/data/usu_individual_T423.rds")
```

```{r}
temp_df <- my_data |> 
  select(NIVEL_ED,CH04,ITF,REGION,MAS_500)
```

## Nombrando variables

```{r}
temp_df |> 
  mutate (Nivel_Educativo = NIVEL_ED)
```

```{r}
temp_df <- temp_df |> 
  mutate (Ingreso = "ITF")
```

```{r}
source(here::here("R/variables-nivel-educativo.R"))
temp_df <- temp_df |> 
  mutate(Nivel_Educativo = nivel_educativo(NIVEL_ED))
temp_df |> 
  select(Nivel_Educativo) |> 
  head()

```

```         
```

```{r}
source(here::here("R/nombrar-regiones.R"))
temp_df <- temp_df |> 
  mutate(REGION = nombrar_regiones(REGION))
temp_df |> 
  select(REGION) |> 
  head()
```

```{r}
temp_df |> 
  mutate (Sexo = "CH04")
```

```{r}
temp_df <- temp_df |> 
  mutate(Sexo = case_when(
    CH04 == "1" ~ "Varon",
    CH04 == "2" ~ "Mujer",
    TRUE ~ "desconocido")
  )
temp_df |> 
  select(Sexo) |> 
  head()
```

```{r}
source(here::here("R/conjunto_de_aglomerados.R"))
temp_df <- temp_df |> 
  mutate(aglomerados = conjunto_de_aglomerados(MAS_500))
temp_df |> 
  select(MAS_500) |> 
  head()

```

## Analisis descriptivo e inferencial

### Regiones

```{r}
my_data <- my_data |> 
  mutate(Nivel_Educativo = NIVEL_ED) |>  
  mutate(Region = case_when( 
             REGION == 01 ~ "Gran Buenos Aires",
             REGION == 40 ~ "Noroeste",
             REGION == 41 ~ "Noreste",
             REGION == 42 ~ "Cuyo",
             REGION == 43 ~ "Pampeana",
             REGION == 44 ~ "Patagonia",
             TRUE ~ "No Encontrado" 
         )
  )
table(my_data$NIVEL_ED, my_data$Region)
```

```{r}
my_data <- my_data |> 
  mutate(Ingreso = ITF) |>  
  mutate(REGION = case_when( 
             REGION == 01 ~ "Gran Buenos Aires",
             REGION == 40 ~ "Noroeste",
             REGION == 41 ~ "Noreste",
             REGION == 42 ~ "Cuyo",
             REGION == 43 ~ "Pampeana",
             REGION == 44 ~ "Patagonia",
               .default = "desconocido" 
         )
  )

head(table(my_data$ITF, my_data$REGION), 10)

```

```{r}
##1
my_data |> 
  mutate(ingreso = ITF) |> 
  filter(ingreso > 0) |> 
  group_by(Region) |> 
  summarize(
    Media = mean(ingreso),
    Mediana = median(ingreso),
    Desviacion = sd(ingreso),
    Desvio = mad(ingreso)
  )
```

### **Sexo**

```{r}
my_data <- my_data |> 
  mutate(Nivel_Educativo = NIVEL_ED) |> 
  mutate(Sexo = case_when(
    CH04 == "1" ~ "Varon",
    CH04 == "2" ~ "Mujer",
    TRUE ~ "desconocido"
  ))

table(my_data$Sexo, my_data$Nivel_Educativo)
```

```{r}
##2 hacer histograma
my_data <- my_data |> 
   filter(ITF > 0) |> 
  mutate(Ingreso = ITF) |> 
  mutate(Sexo = case_when(
    CH04 == "1" ~ "Varon",
    CH04 == "2" ~ "Mujer",
    TRUE ~ "desconocido"
  ))

head(table(my_data$ITF, my_data$Sexo), 10)

```

```{r}
##Consultar

my_data <- my_data |> filter(ITF<10000000,ITF>0)
hist(my_data$ITF)
```

```{r}
##3
##Consultar porque no  esta la funcion
source(here::here("R/nombrar-ch04.R"))
my_data |> 
  mutate(Sexo = nombrar_ch04(CH04)) |> 
  filter(Ingreso > 0) |> 
  group_by(Sexo) |> 
  summarize(
    Media = mean(Ingreso),
    Desviacion = sd(Ingreso), 
    Mediana = median(Ingreso),
    Desvio = mad(Ingreso)
  )
```

**Aglomeración**

```{r}
my_data <- my_data |> 
  mutate(Nivel_Educativo = NIVEL_ED) |> 
  mutate(conjunto_de_aglomerados = case_when(
    MAS_500 == "N" ~ "menos de 500.000 habitantes",
    MAS_500 == "S" ~ "igual o más de 500.000 habitantes"
  ))

table(my_data$MAS_500, my_data$Nivel_Educativo)
```

```{r}
##4 hacer histograma
my_data <- my_data |> 
  mutate(Ingreso = ITF) |> 
  mutate(conjunto_de_aglomerados = case_when(
    MAS_500 == "N" ~ "menos de 500.000 habitantes",
    MAS_500 == "S" ~ "igual o más de 500.000 habitantes"
  ))

head(table(my_data$ITF, my_data$MAS_500), 6)

```

```{r}
##consultar
my_data |>
ggplot(aes(ITF))+
geom_histogram()+
xlab("Ingreso total familar")+
ylab("Conjunto de aglomerados")

```

```{r}
##5
my_data |> 
  mutate(conjunto_de_aglomerados =conjunto_de_aglomerados(MAS_500)) |> 
  filter(Ingreso > 0) |> 
  group_by(conjunto_de_aglomerados) |> 
  summarize(
    Media = mean(Ingreso),
    Desviacion = sd(Ingreso), 
    Mediana = median(Ingreso),
    Desvio = mad(Ingreso)
  )
```

## Gráficos

**Región**

```{r}
    my_data <- my_data |> 
      mutate(
       Nivel_Educativo =  ifelse(Nivel_Educativo == 7, 0, Nivel_Educativo)
      )
```

```{r}
##Cambio de etiqueta. Consultar
temp_df <- temp_df |> 
  mutate(REGION2 = 
           case_when(
             REGION == "Gran Buenos Aires" ~ "AMBA",
             REGION != "Gran Buenos Aires" ~ "Interior",
            .default = "No Encontrado"))

temp_df <- temp_df |> 
  mutate(NIVEL_ED2 = 
           case_when(
             NIVEL_ED %in% c (1, 3, 5) ~ "Estudio incompleto",
             NIVEL_ED %in% c (2, 4, 6) ~ "Estudio completo",
             NIVEL_ED == 0 ~ "Sin Instruccion",
             .default = "Sin datos"))
```

```{r}
##Consultar
temp_df  |> 
      group_by(NIVEL_ED2, REGION2) |>
      summarize(
        Mediana = median(ITF)
      ) |> 
  ggplot(aes(NIVEL_ED2,Mediana, color = REGION2))+
  geom_line()
```


```{r}
source(here::here("R/variables-nivel-educativo.R"))
temp_df |> 
  mutate(Nivel_Educativo = nivel_educativo(NIVEL_ED)) |> 
  group_by(Nivel_Educativo,REGION2) |> 
  summarize(
    Mediana = median(ITF)
  ) |> 
  ungroup() |> 
  ggplot(aes(Nivel_Educativo,Mediana,fill = REGION2))+
  geom_col(position = "dodge")+
  coord_flip()
```



```{r}
##6
my_data |> 
  filter(Ingreso>10000) |> 
  group_by(NIVEL_ED, REGION) |>
  summarize(
    Mediana = median(Ingreso)
  ) |> 
  ggplot(aes(NIVEL_ED,Mediana,color=REGION))+
  geom_line()
```

```{r}
my_data |> 
 group_by(Nivel_Educativo, REGION) |>
  summarize(
    Mediana = median(Ingreso)
  )
```

**Sexo**

```{r}
my_data |> 
  ##7
  # filter(Ingreso>10000) |> 
  group_by(Nivel_Educativo, Sexo) |>
  summarize(
    Mediana = median(Ingreso)
  ) |> 
  ggplot(aes(Nivel_Educativo,Mediana,color=Sexo))+
  geom_line()+
  geom_point(size=2)
```

```{r}
##8
my_data |> 
 group_by(Nivel_Educativo, Sexo) |>
  summarize(
    Mediana = median(Ingreso)
  )
```

**Aglomerados**

```{r}
my_data |> 
  ##7
  # filter(Ingreso>10000) |> 
  group_by(Nivel_Educativo, MAS_500) |>
  summarize(
    Mediana = median(Ingreso)
  ) |> 
  ggplot(aes(Nivel_Educativo,Mediana,color=MAS_500))+
  geom_line()+
  geom_point(size=2)
```

```{r}
my_data |> 
 group_by(Nivel_Educativo, MAS_500) |>
  summarize(
    Mediana = median(Ingreso)
  )
```
