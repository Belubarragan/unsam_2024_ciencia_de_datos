---
title: "Capítulo Ayuda Social"
format: html
editor: visual
author: "Natalia Luna"
---

## Capítulo de ayuda social: distribución y evolución

## Introducción

En el siguiente capítulo se analizará la distribución de la ayuda social en los individuos de la población argentina durante los periodos del cuarto trimestre del año 2022 y el año 2023. Tambien analizaremos la evolución de la ayuda social durante estos mismos periodos, con el propósito de identificar si hubo diferencias. Para ello se utilizarán los datos obtenidos del Instituto Nacional de estadísticas y censo (@indec) obtenidos en los años ya mencionados.

### Herramientas de análisis

Para la realización del presente análisis se utilizó el lenguaje de programación R @base con los paquetes de tidyverse @tidyverse. Asimismo, se utilizó el sistema Quarto @Allaire_Quarto_2024.

### Procedimiento

Extraemos de la base de datos de INDEC, los periodos que comprenden el cuarto trimestre de los años 2022 y 2023. De los cuales, seleccionaremos los prospectos individuales que han recibido una ayuda social. Luego, para obtener información mas detallada, seleccionamos las regiones, los aglomerados (como cuidades grandes y cuidades pequeñas en relacion a mayor o menor concentración), .

```{r}
#| include: false
library(tidyverse)
```

```{r}

usu_individual_T422 <- readRDS(here::here("data/usu_individual_T422.rds"))
usu_individual_T423 <- readRDS(here::here("data/usu_individual_T423.rds"))
```

```{r}
source(here::here("R/agregar-uid.R"))

usu_individual_T422 <- usu_individual_T422 |>
  agregar_uid_individual()
usu_individual_T423 <- usu_individual_T423 |>
  agregar_uid_individual()

```

```{r}
usu_individual_T422 |> 
  filter(V5_M > 0) |> 
  nrow()
usu_individual_T423 |> 
  filter(V5_M > 0) |> 
  nrow()
```

```{r}
UIDs <- intersect(usu_individual_T422$UID,usu_individual_T423$UID)

usu_individual_T422_filtrado <- usu_individual_T422 |>
  filter(UID %in% UIDs) |> 
  arrange(CODUSU) |> 
  select(Año = ANO4, Region = REGION, Ciudad_grande = MAS_500, Aglomerado = AGLOMERADO, Sexo = CH04, Monto_ayuda_social = V5_M)
  
usu_individual_T423_filtrado <- usu_individual_T423 |>
  filter(UID %in% UIDs) |> 
  arrange(CODUSU) |> 
  select(Año = ANO4, Region = REGION, Ciudad_grande = MAS_500, Aglomerado = AGLOMERADO, Sexo = CH04, Monto_ayuda_social = V5_M)
```

```{r}
source(here::here("R/nombrar_aglomerados.R"))
source(here::here("R/nombrar-regiones.R"))

usu_individual_T422_filtrado <- usu_individual_T422_filtrado |> 
  mutate(Region = nombrar_regiones(Region)) |>
  mutate(Aglomerado = nombrar_aglomerados(Aglomerado)) |>
  mutate(Ciudad_grande = case_when(
    Ciudad_grande == "S" ~ "Si",
    Ciudad_grande == "N" ~ "No"
  ))

usu_individual_T423_filtrado <- usu_individual_T423_filtrado |> 
  mutate(Region = nombrar_regiones(Region)) |>
  mutate(Aglomerado = nombrar_aglomerados(Aglomerado)) |>
  mutate(Ciudad_grande = case_when(
    Ciudad_grande == "S" ~ "Si",
    Ciudad_grande == "N" ~ "No"
  ))

usu_individual_T422_filtrado
```

```{r}
usu_individual_T422_T423_f <- bind_rows(
  usu_individual_T422_filtrado,
  usu_individual_T423_filtrado 
)

usu_individual_T422_T423_f
```

```{r}
source(here::here("R/graficar_ayuda_social_2022_2023.R"))

usu_individual_T422_T423_f |> 
  filter(Monto_ayuda_social > 0) |> 
  graficar_ayuda_social_2022_2023()

```

```{r}
ajuste_por_inflacion <- 1 + (211.4 / 100)

usu_individual_T422_T423_f |> 
  mutate(Monto_ayuda_social = ifelse(Año == 2022, Monto_ayuda_social * ajuste_por_inflacion, Monto_ayuda_social)) |> 
  filter(Monto_ayuda_social > 0) |> 
  graficar_ayuda_social_2022_2023()
```
